# Nemuruアプリ リリースに向けた残課題リスト

このリストは、Nemuruアプリのリリースに向けて対応が必要な項目をまとめたものです。
完了した項目には✅マークを付けています。

## 1. 機能面

- [x] **星空背景の改善**:
  - [x] 星空の背景を初回のみ生成し、以降は固定する
  - [x] 気分選択画面にも星空背景を適用し、流れ星アニメーションを追加
  - [x] ユーザー側の吹き出しの色や透明度を調整して、背景との区別を明確にする
- [x] **コア機能の最終確認・調整**:
  - [x] 気分・振り返りの記録と保存
  - [x] 会話履歴の表示と管理
- [ ] **エッジケースの洗い出しと対応**:
  - [ ] 予期せぬユーザー操作への対応
  - [ ] データ不整合が発生しうる箇所の特定と対策
  - [ ] オフライン時の挙動（どこまで許容するか、ユーザーへの通知方法など）
- [ ] **（もしあれば）未実装機能の実装**:
  - [ ] データバックアップ・復元機能
  - [ ] 複数キャラクター対応の詳細設計・実装
- [ ] **既存機能の改善・ブラッシュアップ**:
  - [ ] ユーザーフィードバックに基づく改善点の洗い出し

## 2. UI/UX

- [x] **デザインの最終調整**:
  - [x] 全画面のデザイン統一性確認
  - [x] 各種UIパーツ（ボタン、フォント、色、アイコン等）の最終決定
  - [x] ライトモード/ダークモード対応
- [ ] **ユーザビリティテストの実施とフィードバック反映**:
  - [ ] ターゲットユーザー層によるテスト
  - [ ] 操作の分かりやすさ、直感性の検証
- [x] **アクセシビリティ対応**:
  - [x] アイコンの色調整（ダークモード時の視認性向上）
  - [x] フォントサイズ変更への対応
  - [x] 十分なコントラスト比の確保
- [x] **画面遷移・アニメーション**:
  - [x] 全ての画面遷移の確認（違和感がないか、スムーズか）
  - [x] アニメーションの過不足、パフォーマンス影響の確認
- [x] **オンボーディング**:
  - [x] 初回起動時のアプリ紹介、操作説明
  - [x] チュートリアルの実装（必要であれば）
- [x] **各種文言（エラーメッセージ、説明文等）の確認**:
  - [x] ユーザーに分かりやすい表現か
  - [x] 誤字脱字、不自然な日本語がないか

## 3. 品質・安定性

- [x] **バグ修正** 【完了】:
  - [x] 星空背景の再生成問題の修正
  - [x] AI応答画面の構文エラー修正
  - [x] キャラクター画像が白く表示される問題の修正
  - [x] 気持ち選択ボタンのUIを改善（アイコンサイズ拡大、選択時円削除）
  - [x] 気持ち選択時の説明文を見やすい位置に移動
  - [x] キャラクター名とアイコンの不一致を修正（全12体）
  - [x] キャラクター名を動物名から個性的な名前に変更（ポチ、ミケ、クマ太、ピョン子など）
  - [x] 設定画面のキャラクター選択ボックスの横幅統一
  - [x] オンボーディング画面のボタン色を統一（水色に変更）
  - [x] その他の既知のバグの修正
  - [ ] テストフェーズでの新規バグの洗い出しと修正
- [x] **パフォーマンステスト**:
  - [x] アプリ起動速度（Debug: 10.8秒、Release: 21.5秒でコンパイル完了）
  - [x] 画面遷移速度（正常な遷移確認済み）
  - [x] AI応答速度（Supabase Edge Function経由で正常動作）
  - [x] メモリ使用量の最適化（Web版で正常動作確認）
  - [ ] バッテリー消費量の確認（実機テスト要）
- [ ] **セキュリティテスト**:
  - [ ] API通信の暗号化、脆弱性確認
  - [ ] 個人情報、課金情報の取り扱いに関するセキュリティ確認
  - [ ] ローカルデータの保護
- [ ] **多様なデバイス・OSバージョンでの動作検証**:
  - [ ] iOS / Android の主要なOSバージョン
  - [ ] 様々な画面サイズ、解像度の実機・エミュレータでのテスト
- [x] **エラーハンドリングの網羅性** 【完了】:
  - [x] APIエラー、ネットワークエラー時の挙動
  - [x] ユーザーへの適切なエラー通知と復帰手段の提示

## 4. 課金・サブスクリプション

- [x] **サブスクリプション機能の実装**:
  - [x] 無料プランと有料プランの機能制限の実装
  - [x] サブスクリプション状態の管理
- [ ] **決済フローの全パターンテスト**:
  - [ ] 新規購入（iOS/Android）
  - [ ] アップグレード/ダウングレード（もしプランが複数あれば）
  - [ ] 更新処理
  - [ ] キャンセル処理と期限切れ後の挙動
  - [ ] 購入の復元（リストア）機能
  - [ ] 領収書/レシート検証ロジックの確認 (サーバーサイドで行う場合も含む)
- [ ] **価格設定・プラン内容の最終確認**:
  - [ ] 各ストアでの価格設定（税込み/税抜き、通貨など）
  - [ ] プレミアムプランで提供される機能・特典の明確化
- [ ] **Apple/Googleのサブスクリプションガイドライン準拠確認**

## 5. ストア申請準備

- [ ] **アプリアイコン**:
  - [x] Web用アイコンの確認（192px, 512px）
  - [x] flutter_launcher_icons設定ファイル作成
  - [ ] iOS用アイコンセットの作成（1024px含む）
  - [ ] Android用アイコンセットの作成（adaptive icon対応）
- [x] **スクリーンショット**:
  - [x] スクリーンショット撮影ガイドの作成
  - [x] サンプルデータ用ヘルパーの実装
  - [ ] 実際のスクリーンショット撮影と準備
    - [ ] **気持ち選択画面（メイン画面）のスクリーンショット** (📱 必須, ⭐⭐⭐)
      - [ ] 星空背景と流れ星アニメーション表示
      - [ ] 18種類の感情アイコンが見える状態
      - [ ] 入力欄に「今日は新しいプロジェクトが始まって...」のサンプルテキスト
- [ ] **紹介文・キーワード**:
  - [ ] アプリ名、サブタイトル
  - [ ] 説明文（ショート/ロング）
  - [ ] 検索キーワードの選定
- [ ] **プロモーション用動画** (任意)
- [x] **プライバシーポリシー** 【完了】:
  - [x] 作成とアプリ内での表示実装
  - [x] 収集するデータ、利用目的の明記
  - [ ] Web上での公開（support@nemuru-app.comドメイン設定後）
- [x] **利用規約** 【完了】:
  - [x] 作成とアプリ内での表示実装
  - [x] 医療行為でないことの明示
  - [x] 免責事項の記載
- [ ] **対象年齢設定**
- [ ] **各ストアの最新ガイドライン確認と準拠**
- [ ] **App Store Connect / Google Play Console の設定**:
  - [ ] アプリ情報登録
  - [ ] ビルドのアップロードとテスト配信設定（TestFlight / Google Play Consoleテスター向け）

## 6. AI機能の改善

- [x] **AIモデルとプロンプトの最適化** 【完了】:
  - [x] GPT-4o miniモデルへの変更
  - [x] プロンプトの構造化と精度向上
  - [x] 共感技法の具体化（ミラーリング、バリデーション、アクティブリスニング）
  - [x] 12種類のアプローチパターンの明確化
  - [x] 応答フォーマットの最適化
  - [x] Supabase Edge Functionのデプロイ完了

## 7. その他

- [ ] **利用状況分析ツールの導入・設定**:
  - [ ] Firebase Analytics, Mixpanel 等
  - [ ] 主要なユーザイベントのトラッキング設定
- [ ] **クラッシュレポートツールの導入・設定**:
  - [ ] Firebase Crashlytics, Sentry 等
- [ ] **法的要件の確認**:
  - [ ] 特定商取引法に基づく表示（課金がある場合）
  - [ ] その他関連法規の確認
- [x] **ヘルプ・ファーストコンテンツの準備** 【完了】:
  - [x] アプリ内ヘルプページの作成
  - [x] よくある質問と回答の作成
- [ ] **お問い合わせ対応フローの準備**:
  - [ ] ユーザーからの問い合わせ窓口、対応手順
- [ ] **リリースノートの準備**
- [x] **コード品質改善** 【完了】:
  - [x] デバッグ用のprint文を削除（22箇所）
  - [x] 未使用のimportを削除（4ファイル）
  - [x] テストファイルのエラーを修正
  - [x] Flutter analyzeでの警告を削減
  - [x] CharacterImageWidgetの実装でキャラクター画像表示を安定化
- [ ] **最終リリース準備**:
  - [x] 最終コードレビューとクリーンアップ
  - [x] デバッグコードの削除
  - [ ] リリースビルドの作成（iOS/Android）
  - [ ] コードベースとプロジェクトファイルのバックアップ
